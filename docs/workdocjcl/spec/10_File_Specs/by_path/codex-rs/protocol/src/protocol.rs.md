# `codex-rs/protocol/src/protocol.rs`

## Identity
- kind: `source`
- ext: `.rs`
- size_bytes: `94821`
- sha256: `386dcc84c3cd8755a093b4fbb67b0274ebf859d57c19039811c8b9dae0d11048`
- generated_utc: `2026-02-08T10:45:38Z`

## Purpose (Why)
Source file implementing exported/public items listed below.

## Interfaces (Inputs/Outputs)
### Inputs
- filesystem: `codex-rs/protocol/src/protocol.rs` (read)
- env: `TMPDIR`

### Outputs / Side Effects
- (no obvious side effects detected by heuristic)

## Public Surface (auto)
- `pub struct Submission {`
- `pub struct McpServerRefreshConfig {`
- `pub enum Op {`
- `pub enum AskForApproval {`
- `pub enum NetworkAccess {`
- `pub fn is_enabled(self) -> bool {`
- `pub enum SandboxPolicy {`
- `pub struct WritableRoot {`
- `pub fn is_path_writable(&self, path: &Path) -> bool {`
- `pub fn new_read_only_policy() -> Self {`
- `pub fn new_workspace_write_policy() -> Self {`
- `pub fn has_full_disk_read_access(&self) -> bool {`
- `pub fn has_full_disk_write_access(&self) -> bool {`
- `pub fn has_full_network_access(&self) -> bool {`
- `pub fn get_writable_roots_with_cwd(&self, cwd: &Path) -> Vec<WritableRoot> {`
- `pub struct Event {`
- `pub enum EventMsg {`
- `pub enum AgentStatus {`
- `pub enum CodexErrorInfo {`
- `pub struct RawResponseItemEvent {`
- `pub struct ItemStartedEvent {`
- `pub struct ItemCompletedEvent {`
- `pub trait HasLegacyEvent {`
- `pub struct AgentMessageContentDeltaEvent {`
- `pub struct PlanDeltaEvent {`
- `pub struct ReasoningContentDeltaEvent {`
- `pub struct ReasoningRawContentDeltaEvent {`
- `pub struct ExitedReviewModeEvent {`
- `pub struct ErrorEvent {`
- `pub struct WarningEvent {`
- `pub struct ContextCompactedEvent;`
- `pub struct TurnCompleteEvent {`
- `pub struct TurnStartedEvent {`
- `pub struct TokenUsage {`
- `pub struct TokenUsageInfo {`
- `pub fn new_or_append(`
- `pub fn append_last_usage(&mut self, last: &TokenUsage) {`
- `pub fn fill_to_context_window(&mut self, context_window: i64) {`
- `pub fn full_context_window(context_window: i64) -> Self {`
- `pub struct TokenCountEvent {`
- `pub struct RateLimitSnapshot {`
- `pub struct RateLimitWindow {`
- `pub struct CreditsSnapshot {`
- `pub fn is_zero(&self) -> bool {`
- `pub fn cached_input(&self) -> i64 {`
- `pub fn non_cached_input(&self) -> i64 {`
- `pub fn blended_total(&self) -> i64 {`
- `pub fn tokens_in_context_window(&self) -> i64 {`
- `pub fn percent_of_context_window_remaining(&self, context_window: i64) -> i64 {`
- `pub fn add_assign(&mut self, other: &TokenUsage) {`

## Definitions (auto, per-file)
- `use` `codex-rs/protocol/src/protocol.rs:6` `use std::collections::HashMap;`
- `use` `codex-rs/protocol/src/protocol.rs:7` `use std::ffi::OsStr;`
- `use` `codex-rs/protocol/src/protocol.rs:8` `use std::fmt;`
- `use` `codex-rs/protocol/src/protocol.rs:9` `use std::path::Path;`
- `use` `codex-rs/protocol/src/protocol.rs:10` `use std::path::PathBuf;`
- `use` `codex-rs/protocol/src/protocol.rs:11` `use std::str::FromStr;`
- `use` `codex-rs/protocol/src/protocol.rs:12` `use std::time::Duration;`
- `use` `codex-rs/protocol/src/protocol.rs:14` `use crate::ThreadId;`
- `use` `codex-rs/protocol/src/protocol.rs:15` `use crate::approvals::ElicitationRequestEvent;`
- `use` `codex-rs/protocol/src/protocol.rs:16` `use crate::config_types::CollaborationMode;`
- `use` `codex-rs/protocol/src/protocol.rs:17` `use crate::config_types::ModeKind;`
- `use` `codex-rs/protocol/src/protocol.rs:18` `use crate::config_types::Personality;`
- `use` `codex-rs/protocol/src/protocol.rs:19` `use crate::config_types::ReasoningSummary as ReasoningSummaryConfig;`
- `use` `codex-rs/protocol/src/protocol.rs:20` `use crate::config_types::WindowsSandboxLevel;`
- `use` `codex-rs/protocol/src/protocol.rs:21` `use crate::custom_prompts::CustomPrompt;`
- `use` `codex-rs/protocol/src/protocol.rs:22` `use crate::dynamic_tools::DynamicToolCallRequest;`
- `use` `codex-rs/protocol/src/protocol.rs:23` `use crate::dynamic_tools::DynamicToolResponse;`
- `use` `codex-rs/protocol/src/protocol.rs:24` `use crate::dynamic_tools::DynamicToolSpec;`
- `use` `codex-rs/protocol/src/protocol.rs:25` `use crate::items::TurnItem;`
- `use` `codex-rs/protocol/src/protocol.rs:26` `use crate::mcp::CallToolResult;`
- `use` `codex-rs/protocol/src/protocol.rs:27` `use crate::mcp::RequestId;`
- `use` `codex-rs/protocol/src/protocol.rs:28` `use crate::mcp::Resource as McpResource;`
- `use` `codex-rs/protocol/src/protocol.rs:29` `use crate::mcp::ResourceTemplate as McpResourceTemplate;`
- `use` `codex-rs/protocol/src/protocol.rs:30` `use crate::mcp::Tool as McpTool;`
- `use` `codex-rs/protocol/src/protocol.rs:31` `use crate::message_history::HistoryEntry;`
- `use` `codex-rs/protocol/src/protocol.rs:32` `use crate::models::BaseInstructions;`
- `use` `codex-rs/protocol/src/protocol.rs:33` `use crate::models::ContentItem;`
- `use` `codex-rs/protocol/src/protocol.rs:34` `use crate::models::ResponseItem;`
- `use` `codex-rs/protocol/src/protocol.rs:35` `use crate::models::WebSearchAction;`
- `use` `codex-rs/protocol/src/protocol.rs:36` `use crate::num_format::format_with_separators;`
- `use` `codex-rs/protocol/src/protocol.rs:37` `use crate::openai_models::ReasoningEffort as ReasoningEffortConfig;`
- `use` `codex-rs/protocol/src/protocol.rs:38` `use crate::parse_command::ParsedCommand;`
- `use` `codex-rs/protocol/src/protocol.rs:39` `use crate::plan_tool::UpdatePlanArgs;`
- `use` `codex-rs/protocol/src/protocol.rs:40` `use crate::request_user_input::RequestUserInputResponse;`
- `use` `codex-rs/protocol/src/protocol.rs:41` `use crate::user_input::UserInput;`
- `use` `codex-rs/protocol/src/protocol.rs:42` `use codex_utils_absolute_path::AbsolutePathBuf;`
- `use` `codex-rs/protocol/src/protocol.rs:43` `use schemars::JsonSchema;`
- `use` `codex-rs/protocol/src/protocol.rs:44` `use serde::Deserialize;`
- `use` `codex-rs/protocol/src/protocol.rs:45` `use serde::Serialize;`
- `use` `codex-rs/protocol/src/protocol.rs:46` `use serde_json::Value;`
- `use` `codex-rs/protocol/src/protocol.rs:47` `use serde_with::serde_as;`
- `use` `codex-rs/protocol/src/protocol.rs:48` `use strum_macros::Display;`
- `use` `codex-rs/protocol/src/protocol.rs:49` `use tracing::error;`
- `use` `codex-rs/protocol/src/protocol.rs:50` `use ts_rs::TS;`
- `const` `codex-rs/protocol/src/protocol.rs:60` `pub const USER_INSTRUCTIONS_OPEN_TAG: &str = "<user_instructions>";`
- `const` `codex-rs/protocol/src/protocol.rs:61` `pub const USER_INSTRUCTIONS_CLOSE_TAG: &str = "</user_instructions>";`
- `const` `codex-rs/protocol/src/protocol.rs:62` `pub const ENVIRONMENT_CONTEXT_OPEN_TAG: &str = "<environment_context>";`
- `const` `codex-rs/protocol/src/protocol.rs:63` `pub const ENVIRONMENT_CONTEXT_CLOSE_TAG: &str = "</environment_context>";`
- `const` `codex-rs/protocol/src/protocol.rs:64` `pub const COLLABORATION_MODE_OPEN_TAG: &str = "<collaboration_mode>";`
- `const` `codex-rs/protocol/src/protocol.rs:65` `pub const COLLABORATION_MODE_CLOSE_TAG: &str = "</collaboration_mode>";`
- `const` `codex-rs/protocol/src/protocol.rs:66` `pub const USER_MESSAGE_BEGIN: &str = "## My request for Codex:";`
- `struct` `codex-rs/protocol/src/protocol.rs:70` `pub struct Submission {`
- `struct` `codex-rs/protocol/src/protocol.rs:79` `pub struct McpServerRefreshConfig {`
- `enum` `codex-rs/protocol/src/protocol.rs:89` `pub enum Op {`
- `enum` `codex-rs/protocol/src/protocol.rs:338` `pub enum AskForApproval {`
- `enum` `codex-rs/protocol/src/protocol.rs:367` `pub enum NetworkAccess {`
- `impl` `codex-rs/protocol/src/protocol.rs:373` `impl NetworkAccess {`
- `fn` `codex-rs/protocol/src/protocol.rs:374` `pub fn is_enabled(self) -> bool {`
- `enum` `codex-rs/protocol/src/protocol.rs:383` `pub enum SandboxPolicy {`
- `struct` `codex-rs/protocol/src/protocol.rs:434` `pub struct WritableRoot {`
- `impl` `codex-rs/protocol/src/protocol.rs:441` `impl WritableRoot {`
- `fn` `codex-rs/protocol/src/protocol.rs:442` `pub fn is_path_writable(&self, path: &Path) -> bool {`
- `impl` `codex-rs/protocol/src/protocol.rs:459` `impl FromStr for SandboxPolicy {`
- `type` `codex-rs/protocol/src/protocol.rs:460` `type Err = serde_json::Error;`
- `fn` `codex-rs/protocol/src/protocol.rs:462` `fn from_str(s: &str) -> Result<Self, Self::Err> {`
- `impl` `codex-rs/protocol/src/protocol.rs:467` `impl SandboxPolicy {`
- `fn` `codex-rs/protocol/src/protocol.rs:469` `pub fn new_read_only_policy() -> Self {`
- `fn` `codex-rs/protocol/src/protocol.rs:476` `pub fn new_workspace_write_policy() -> Self {`
- `fn` `codex-rs/protocol/src/protocol.rs:486` `pub fn has_full_disk_read_access(&self) -> bool {`
- `fn` `codex-rs/protocol/src/protocol.rs:490` `pub fn has_full_disk_write_access(&self) -> bool {`
- `fn` `codex-rs/protocol/src/protocol.rs:499` `pub fn has_full_network_access(&self) -> bool {`
- `fn` `codex-rs/protocol/src/protocol.rs:511` `pub fn get_writable_roots_with_cwd(&self, cwd: &Path) -> Vec<WritableRoot> {`
- `fn` `codex-rs/protocol/src/protocol.rs:624` `fn is_git_pointer_file(path: &AbsolutePathBuf) -> bool {`
- `fn` `codex-rs/protocol/src/protocol.rs:628` `fn resolve_gitdir_from_file(dot_git: &AbsolutePathBuf) -> Option<AbsolutePathBuf> {`
- `struct` `codex-rs/protocol/src/protocol.rs:691` `pub struct Event {`
- `enum` `codex-rs/protocol/src/protocol.rs:704` `pub enum EventMsg {`
- `impl` `codex-rs/protocol/src/protocol.rs:888` `impl From<CollabAgentSpawnBeginEvent> for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:889` `fn from(event: CollabAgentSpawnBeginEvent) -> Self {`
- `impl` `codex-rs/protocol/src/protocol.rs:894` `impl From<CollabAgentSpawnEndEvent> for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:895` `fn from(event: CollabAgentSpawnEndEvent) -> Self {`
- `impl` `codex-rs/protocol/src/protocol.rs:900` `impl From<CollabAgentInteractionBeginEvent> for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:901` `fn from(event: CollabAgentInteractionBeginEvent) -> Self {`
- `impl` `codex-rs/protocol/src/protocol.rs:906` `impl From<CollabAgentInteractionEndEvent> for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:907` `fn from(event: CollabAgentInteractionEndEvent) -> Self {`
- `impl` `codex-rs/protocol/src/protocol.rs:912` `impl From<CollabWaitingBeginEvent> for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:913` `fn from(event: CollabWaitingBeginEvent) -> Self {`
- `impl` `codex-rs/protocol/src/protocol.rs:918` `impl From<CollabWaitingEndEvent> for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:919` `fn from(event: CollabWaitingEndEvent) -> Self {`
- `impl` `codex-rs/protocol/src/protocol.rs:924` `impl From<CollabCloseBeginEvent> for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:925` `fn from(event: CollabCloseBeginEvent) -> Self {`
- `impl` `codex-rs/protocol/src/protocol.rs:930` `impl From<CollabCloseEndEvent> for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:931` `fn from(event: CollabCloseEndEvent) -> Self {`
- `impl` `codex-rs/protocol/src/protocol.rs:936` `impl From<CollabResumeBeginEvent> for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:937` `fn from(event: CollabResumeBeginEvent) -> Self {`
- `impl` `codex-rs/protocol/src/protocol.rs:942` `impl From<CollabResumeEndEvent> for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:943` `fn from(event: CollabResumeEndEvent) -> Self {`
- `enum` `codex-rs/protocol/src/protocol.rs:952` `pub enum AgentStatus {`
- `enum` `codex-rs/protocol/src/protocol.rs:972` `pub enum CodexErrorInfo {`
- `struct` `codex-rs/protocol/src/protocol.rs:1003` `pub struct RawResponseItemEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1008` `pub struct ItemStartedEvent {`
- `impl` `codex-rs/protocol/src/protocol.rs:1014` `impl HasLegacyEvent for ItemStartedEvent {`
- `fn` `codex-rs/protocol/src/protocol.rs:1015` `fn as_legacy_events(&self, _: bool) -> Vec<EventMsg> {`
- `struct` `codex-rs/protocol/src/protocol.rs:1026` `pub struct ItemCompletedEvent {`
- `trait` `codex-rs/protocol/src/protocol.rs:1032` `pub trait HasLegacyEvent {`
- `fn` `codex-rs/protocol/src/protocol.rs:1033` `fn as_legacy_events(&self, show_raw_agent_reasoning: bool) -> Vec<EventMsg>;`
- `impl` `codex-rs/protocol/src/protocol.rs:1036` `impl HasLegacyEvent for ItemCompletedEvent {`
- `fn` `codex-rs/protocol/src/protocol.rs:1037` `fn as_legacy_events(&self, show_raw_agent_reasoning: bool) -> Vec<EventMsg> {`
- `struct` `codex-rs/protocol/src/protocol.rs:1043` `pub struct AgentMessageContentDeltaEvent {`
- `impl` `codex-rs/protocol/src/protocol.rs:1050` `impl HasLegacyEvent for AgentMessageContentDeltaEvent {`
- `fn` `codex-rs/protocol/src/protocol.rs:1051` `fn as_legacy_events(&self, _: bool) -> Vec<EventMsg> {`
- `struct` `codex-rs/protocol/src/protocol.rs:1059` `pub struct PlanDeltaEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1067` `pub struct ReasoningContentDeltaEvent {`
- `impl` `codex-rs/protocol/src/protocol.rs:1077` `impl HasLegacyEvent for ReasoningContentDeltaEvent {`
- `fn` `codex-rs/protocol/src/protocol.rs:1078` `fn as_legacy_events(&self, _: bool) -> Vec<EventMsg> {`
- `struct` `codex-rs/protocol/src/protocol.rs:1086` `pub struct ReasoningRawContentDeltaEvent {`
- `impl` `codex-rs/protocol/src/protocol.rs:1096` `impl HasLegacyEvent for ReasoningRawContentDeltaEvent {`
- `fn` `codex-rs/protocol/src/protocol.rs:1097` `fn as_legacy_events(&self, _: bool) -> Vec<EventMsg> {`
- `impl` `codex-rs/protocol/src/protocol.rs:1106` `impl HasLegacyEvent for EventMsg {`
- `fn` `codex-rs/protocol/src/protocol.rs:1107` `fn as_legacy_events(&self, show_raw_agent_reasoning: bool) -> Vec<EventMsg> {`
- `struct` `codex-rs/protocol/src/protocol.rs:1126` `pub struct ExitedReviewModeEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1133` `pub struct ErrorEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1140` `pub struct WarningEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1145` `pub struct ContextCompactedEvent;`
- `struct` `codex-rs/protocol/src/protocol.rs:1148` `pub struct TurnCompleteEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1153` `pub struct TurnStartedEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1161` `pub struct TokenUsage {`
- `struct` `codex-rs/protocol/src/protocol.rs:1175` `pub struct TokenUsageInfo {`
- `impl` `codex-rs/protocol/src/protocol.rs:1183` `impl TokenUsageInfo {`
- `fn` `codex-rs/protocol/src/protocol.rs:1184` `pub fn new_or_append(`
- `fn` `codex-rs/protocol/src/protocol.rs:1207` `pub fn append_last_usage(&mut self, last: &TokenUsage) {`
- `fn` `codex-rs/protocol/src/protocol.rs:1212` `pub fn fill_to_context_window(&mut self, context_window: i64) {`
- `fn` `codex-rs/protocol/src/protocol.rs:1227` `pub fn full_context_window(context_window: i64) -> Self {`
- `struct` `codex-rs/protocol/src/protocol.rs:1239` `pub struct TokenCountEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1245` `pub struct RateLimitSnapshot {`
- `struct` `codex-rs/protocol/src/protocol.rs:1253` `pub struct RateLimitWindow {`
- `struct` `codex-rs/protocol/src/protocol.rs:1265` `pub struct CreditsSnapshot {`
- `const` `codex-rs/protocol/src/protocol.rs:1272` `const BASELINE_TOKENS: i64 = 12000;`
- `impl` `codex-rs/protocol/src/protocol.rs:1274` `impl TokenUsage {`
- `fn` `codex-rs/protocol/src/protocol.rs:1275` `pub fn is_zero(&self) -> bool {`
- `fn` `codex-rs/protocol/src/protocol.rs:1279` `pub fn cached_input(&self) -> i64 {`
- `fn` `codex-rs/protocol/src/protocol.rs:1283` `pub fn non_cached_input(&self) -> i64 {`
- `fn` `codex-rs/protocol/src/protocol.rs:1288` `pub fn blended_total(&self) -> i64 {`
- `fn` `codex-rs/protocol/src/protocol.rs:1292` `pub fn tokens_in_context_window(&self) -> i64 {`
- `fn` `codex-rs/protocol/src/protocol.rs:1306` `pub fn percent_of_context_window_remaining(&self, context_window: i64) -> i64 {`
- `fn` `codex-rs/protocol/src/protocol.rs:1320` `pub fn add_assign(&mut self, other: &TokenUsage) {`
- `struct` `codex-rs/protocol/src/protocol.rs:1330` `pub struct FinalOutput {`
- `impl` `codex-rs/protocol/src/protocol.rs:1334` `impl From<TokenUsage> for FinalOutput {`
- `fn` `codex-rs/protocol/src/protocol.rs:1335` `fn from(token_usage: TokenUsage) -> Self {`
- `impl` `codex-rs/protocol/src/protocol.rs:1340` `impl fmt::Display for FinalOutput {`
- `fn` `codex-rs/protocol/src/protocol.rs:1341` `fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {`
- `struct` `codex-rs/protocol/src/protocol.rs:1371` `pub struct AgentMessageEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1376` `pub struct UserMessageEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1394` `pub struct AgentMessageDeltaEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1399` `pub struct AgentReasoningEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1404` `pub struct AgentReasoningRawContentEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1409` `pub struct AgentReasoningRawContentDeltaEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1414` `pub struct AgentReasoningSectionBreakEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1423` `pub struct AgentReasoningDeltaEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1428` `pub struct McpInvocation {`
- `struct` `codex-rs/protocol/src/protocol.rs:1438` `pub struct McpToolCallBeginEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1445` `pub struct McpToolCallEndEvent {`
- `impl` `codex-rs/protocol/src/protocol.rs:1455` `impl McpToolCallEndEvent {`
- `fn` `codex-rs/protocol/src/protocol.rs:1456` `pub fn is_success(&self) -> bool {`
- `struct` `codex-rs/protocol/src/protocol.rs:1465` `pub struct WebSearchBeginEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1470` `pub struct WebSearchEndEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1480` `pub struct ConversationPathResponseEvent {`
- `struct` `codex-rs/protocol/src/protocol.rs:1486` `pub struct ResumedHistory {`
- `enum` `codex-rs/protocol/src/protocol.rs:1493` `pub enum InitialHistory {`
- `impl` `codex-rs/protocol/src/protocol.rs:1499` `impl InitialHistory {`
- `fn` `codex-rs/protocol/src/protocol.rs:1500` `pub fn forked_from_id(&self) -> Option<ThreadId> {`
- `fn` `codex-rs/protocol/src/protocol.rs:1516` `pub fn session_cwd(&self) -> Option<PathBuf> {`
- `fn` `codex-rs/protocol/src/protocol.rs:1524` `pub fn get_rollout_items(&self) -> Vec<RolloutItem> {`
- `fn` `codex-rs/protocol/src/protocol.rs:1532` `pub fn get_event_msgs(&self) -> Option<Vec<EventMsg>> {`
- `fn` `codex-rs/protocol/src/protocol.rs:1557` `pub fn get_base_instructions(&self) -> Option<BaseInstructions> {`
- `fn` `codex-rs/protocol/src/protocol.rs:1574` `pub fn get_dynamic_tools(&self) -> Option<Vec<DynamicToolSpec>> {`
- `fn` `codex-rs/protocol/src/protocol.rs:1591` `fn session_cwd_from_items(items: &[RolloutItem]) -> Option<PathBuf> {`
- `enum` `codex-rs/protocol/src/protocol.rs:1601` `pub enum SessionSource {`
- `enum` `codex-rs/protocol/src/protocol.rs:1615` `pub enum SubAgentSource {`
- `impl` `codex-rs/protocol/src/protocol.rs:1625` `impl fmt::Display for SessionSource {`
- `fn` `codex-rs/protocol/src/protocol.rs:1626` `fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {`
- `impl` `codex-rs/protocol/src/protocol.rs:1638` `impl fmt::Display for SubAgentSource {`
- `fn` `codex-rs/protocol/src/protocol.rs:1639` `fn fmt(&self, f: &mut fmt::Formatter<'_>) -> fmt::Result {`
- `struct` `codex-rs/protocol/src/protocol.rs:1660` `pub struct SessionMeta {`
- `impl` `codex-rs/protocol/src/protocol.rs:1679` `impl Default for SessionMeta {`
- `fn` `codex-rs/protocol/src/protocol.rs:1680` `fn default() -> Self {`
- `struct` `codex-rs/protocol/src/protocol.rs:1697` `pub struct SessionMetaLine {`
- `enum` `codex-rs/protocol/src/protocol.rs:1706` `pub enum RolloutItem {`
- `struct` `codex-rs/protocol/src/protocol.rs:1715` `pub struct CompactedItem {`
- `impl` `codex-rs/protocol/src/protocol.rs:1721` `impl From<CompactedItem> for ResponseItem {`
- `fn` `codex-rs/protocol/src/protocol.rs:1722` `fn from(value: CompactedItem) -> Self {`
- `struct` `codex-rs/protocol/src/protocol.rs:1736` `pub struct TurnContextItem {`
- `enum` `codex-rs/protocol/src/protocol.rs:1760` `pub enum TruncationPolicy {`
- `struct` `codex-rs/protocol/src/protocol.rs:1766` `pub struct RolloutLine {`
- `struct` `codex-rs/protocol/src/protocol.rs:1773` `pub struct GitInfo {`
- `enum` `codex-rs/protocol/src/protocol.rs:1787` `pub enum ReviewDelivery {`
- `enum` `codex-rs/protocol/src/protocol.rs:1795` `pub enum ReviewTarget {`
- `struct` `codex-rs/protocol/src/protocol.rs:1821` `pub struct ReviewRequest {`
- `struct` `codex-rs/protocol/src/protocol.rs:1830` `pub struct ReviewOutputEvent {`
- `impl` `codex-rs/protocol/src/protocol.rs:1837` `impl Default for ReviewOutputEvent {`
- `fn` `codex-rs/protocol/src/protocol.rs:1838` `fn default() -> Self {`
- (â€¦ 79 more definitions omitted; see symbol indexes under `docs/workdocjcl/spec/13_Indexes/`)

## Dependencies (auto sample)
### Imports / Includes
- `use std::collections::HashMap;`
- `use std::ffi::OsStr;`
- `use std::fmt;`
- `use std::path::Path;`
- `use std::path::PathBuf;`
- `use std::str::FromStr;`
- `use std::time::Duration;`
- `use crate::ThreadId;`
- `use crate::approvals::ElicitationRequestEvent;`
- `use crate::config_types::CollaborationMode;`
- `use crate::config_types::ModeKind;`
- `use crate::config_types::Personality;`
- `use crate::config_types::ReasoningSummary as ReasoningSummaryConfig;`
- `use crate::config_types::WindowsSandboxLevel;`
- `use crate::custom_prompts::CustomPrompt;`
- `use crate::dynamic_tools::DynamicToolCallRequest;`
- `use crate::dynamic_tools::DynamicToolResponse;`
- `use crate::dynamic_tools::DynamicToolSpec;`
- `use crate::items::TurnItem;`
- `use crate::mcp::CallToolResult;`
### Referenced env vars
- `TMPDIR`

## Error Handling / Edge Cases
- has retry/timeout/backoff logic
- returns structured errors (Result/ErrorKind)
- uses Rust panic/expect/unwrap-style failure paths

## Spec Links
- `docs/workdocjcl/spec/02_Data/ROLLOUT_FORMAT.md`
